{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "__id": "https://raw.github.com/nilmtk/nilm_metadata/master/schema/prior.json",
    "title": "Prior",
    "description": "Represent prior knowledge. For continuous variables, specify either the distribution of data (i.e. the data represented in a histogram), or a density estimate (a model fitted to the data), or both.  For categorical variables, specify the categorical distribution.",
    "type": "object",
    "additionalProperties": false,
    "properties": {
        "distribution_of_data": {
            "type": "object",
            "additionalProperties": false,
            "description": "Distribution of the data expressed as normalised frequencies per discrete bin (for continuous variables) or per category (for categorical variables).  'categories' can be used instead of 'bin_edges' for continuous variables where it makes sense; e.g. where each bin represents a day of the week",
            "properties": {
                "bin_edges": { 
                    "type": "array", 
                    "items": { 
                        "oneOf": [ 
                            { "type": "number" }, 
                            { "type": "string" } 
                        ] 
                    },
                    "required": true,
                    "description": "|bin_edges| == |values| + 1"
                },
                "categories": {
                    "type": "array",
                    "items": { "type": "string" },
                    "required": true,
                    "description": "|bin_edges| == |values|"
                },
                "values": {
                    "type": "array",
                    "items": { "type": "number" },
                    "description": "The normalised frequencies.  For continuous variables, in integral over the range must be 1.  For categorical variables, the sum of frequences can be <= 1.  If < 1 then the system will assume that the remaining mass is distributed equaly across all other categories.  For example, for the probability of a fridge being in a specific room, it is sufficient to just state that the probability is 0.9 for a fridge to be in the kitchen.",
                    "required": true
                }
            }
        },
        "model": {
            "type": "object",
            "description": "A fitted model to describe the probability density function (for continuous variables) or the probability mass function (for discrete variables).  Use additional properties for the relevant parameters, written as Greek letters spelt out in lowercase English e.g. 'mu' and 'lambda' except for summary stats where we use some combination of 'min', 'max', 'mean', 'mode'.",
            "properties": {
                "distribution_name": { 
                    "enum": [ "normal", "inverse gaussian", "summary stats" ] },
                "sum_of_squared_error": { "type": "number" }
            },
            "additionalProperties": true
        },
        "n_datapoints": { "type": "integer" },
        "date_prepared": { "type": "string", "format": "date" },
        "source": { 
            "enum": [ 
                "subjective", 
                "empirical from data",
                "empirical from publication" 
            ],
            "description": "What is the source of this prior?"
        },
        "related_documents": { 
            "type": "array",
            "items": { "type": "string" },
            "description": "If source=='empirical from publication' then enter the refenerence here."
        },
        "software": { 
            "type": "object",
            "description": "the software used to generate the prior from data.",
            "properties": { "$ref": "device.json#/properties"  },
            "additionalProperties": false
        },
        "specific_to": {
            "type": "object",
            "properties": {
                "country": { 
                    "type": "string",
                    "description": "standard two-letter country code defined by ISO 3166-1 alpha-2. e.g. 'GB' or 'US'.  http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2)."
                },
                "continent": { 
                    "type": "string",
                    "description": "standard two-letter continent code defined at http://en.wikipedia.org/wiki/List_of_sovereign_states_and_dependent_territories_by_continent_%28data_file%29."
                }
            }
        },
        "distance": {
            "type": "integer",
            "desciption": "this is filled in by the `concatenate_complete_object` function and reports the distance (in numbers of generations) between this prior and the most-derived object.  In other words, the larger this number, the less specific to the object this prior is.  If this is not set the the prior applies to the current object."
        },
        "description": { "type": "string" },
        "training_data": {
            "type": "array",
            "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "dataset": { "type": "string" },
                    "buildings": { 
                        "type": "array", 
                        "items": { 
                            "type": "object",
                            "properties": {
                                "building_id": { "type": "integer" },
                                "dates": { 
                                    "type": "array",
                                    "items": { "$ref": "timeframe.json" }
                                },
                                "country": { "type": "string" }
                            }
                        }
                    }
                }
            }
        }
    }
}
