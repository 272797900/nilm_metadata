{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "https://raw.github.com/nilmtk/nilm_metadata/master/schema/appliance.json",
    "title": "Appliance",
    "description": "Metadata for a Appliances",
    "type": "object",
    "allOf": [
        { 
            "_comments": "------PROPERTIES COMMON TO ALL APPLIANCES----------",
            "properties": {
                "instance": { "$ref": "instance.json" },
                "room": { "$ref": "room.json" },
                "manufacturer": { "type": "string" },
                "model": { "type": "string" },
                "meters": { 
                    "type": "array", 
                    "items": { "$ref": "instance.json" },
                    "unique": true 
                },
                "on_power_threshold": { 
                    "type": "number", 
                    "description": "watts", 
                    "minimum": 0
                },
                "min_off_duration": { "format": "time", "type": "string" },
                "min_on_duration": { "format": "time", "type": "string" },
                "category": { "type": "string" },
                "dates_active": {
                    "type": "array",
                    "items": { "$ref": "timeframe.json" }
                }
            },
            "required": ["name"]
        },
        { 
            "$ref": "#/all_subclasses"
        }
    ],
    "all_subclasses": {
        "oneOf": 
        [
                { "$ref": "#/subclasses/fridge" },
                { "$ref": "#/subclasses/screen" },
                { "$ref": "#/subclasses/games_console" },
                { "$ref": "#/subclasses/projector" },
                { "$ref": "#/subclasses/av_source" },
                { "$ref": "#/subclasses/amp" },
                { "$ref": "#/subclasses/kitchen_misc" },
                { "$ref": "#/subclasses/cooker" },
                { "$ref": "#/subclasses/oven" },
                { "$ref": "#/subclasses/hob_or_grill" },
                { "$ref": "#/subclasses/sockets_and_room_specific_misc" },
                { "$ref": "#/subclasses/heating" },
                { "$ref": "#/subclasses/heat_pump" },
                { "$ref": "#/subclasses/shower_or_tub" },
                { "$ref": "#/subclasses/pump" },
                { "$ref": "#/subclasses/printer" },
                { "$ref": "#/subclasses/office" },
                { "$ref": "#/subclasses/charger" },
                { "$ref": "#/subclasses/misc" }
        ]
    },
   
    "subclasses": {

        "fridge": {   
            "properties": {
                "name": { "enum": ["fridge", "fridge freezer", "freezer"] },
                "type": { "enum": ["upright", "chest", "american"] },
                "freezer_is_separate_thermal_zone": { "type": "boolean" }
            }
        },

        "kitchen_misc": {
            "properties": {
                "name": { "enum": [
                    "wine cooler", "food mixer", 
                    "vacuum cleaner", 
                    "yoghurt maker", "water filter",
                    "microwave", "kettle", "toaster", "fryer", "bread maker", 
                    "coffee maker", "food steamer", "bottle warmer", 
                    "steriliser", "plate warmer", "slow cooker", "other cooking"
                ] }
            }
        },

        "screen": {   
            "properties": {
                "name": { "enum": ["tv", "computer monitor"] },
                "screen_size": { 
                    "type": "number",
                    "description": "diagonal size in inches",
                    "minimum": 0,
                    "exclusiveMinimum": true
                },
                "display": { "enum": ["crt", "lcd", "plasma", "oled" ] },
                "backlight": { "enum": ["led", "cold cathode"] }
            }
        },

        "projector": {
            "properties": {
                "name": { "enum": ["projector"] }
            }
        },

        "games_console": {
            "properties": {
                "name": { "enum": ["games console"] },
                "model": { "enum": ["xbox", "xbox 360", "xbox one",
                                    "ps1", "ps2", "ps3", "ps4", 
                                    "wii", "wii u",
                                    "steam box"] }
            }
        },        

        "av_source": {
            "properties": {
                "name": { "enum": ["av source"] },
                "sources": {
                    "type": "array",
                    "items": { 
                        "enum": [
                            "hard disk", "receiver", "dvd", "blu-ray",
                            "videodisc", "tape", "cd", "analogue radio", 
                            "digital radio", "satellite", "cable", 
                            "broadband", "fibre"
                        ]
                    }
                }
            }
        },     

        "amp": {
            "properties": {
                "name": { "enum": ["amp"] },
                "type": { 
                    "enum": [
                        "av", "integrated audio", "pre", "power", "phono", 
                        "active sub", "active speaker"
                    ]
                }
            }
        },     

        "cooker": {
            "properties": {
                "name": { "enum": ["cooker"] },
                "components": { 
                    "type": "array",
                    "description": "meta-appliance made up of other appliances",
                    "items": {
                        "anyOf": [
                            { "$ref": "#/subclasses/oven" },
                            { "$ref": "#/subclasses/hob_or_grill" }
                        ]
                    }
                }
            }
        },

        "oven": {
            "properties": {
                "name": { "enum": ["oven"] },
                "fan": { "type": "boolean" },
                "fuel": { "$ref": "#/definitions/fuel" }
            }
        },

        "hob_or_grill": {
            "properties": {
                "name": { "enum": ["hob", "grill"] },
                "fuel": { "$ref": "#/definitions/fuel" }
            }
        },

        "sockets_and_room_specific_misc": {
            "properties": {
                "name": { "enum": ["sockets", "misc"] }
            },
            "required": ["name", "room"]
        },

        "heating": {
            "properties": {
                "name": { "enum": [ 
                    "boiler", "space heater", "storage heater",
                    "water heater" ] },
                "fuel": { "$ref": "#/definitions/fuel" }
            }
        },

        "heat_pump": {
            "properties": {
                "name": { "enum": ["heat pump", "air conditioning" ] },
                "heat_source": { "enum": ["ground", "air", "water"] }
            }
        },

        "shower_or_tub": {
            "properties": {
                "name": { "enum": ["shower", "hot tub", "jacuzzi"] },
                "components": { 
                    "type": "array",
                    "description": "meta-appliance made up of other appliances",
                    "items": {
                        "anyOf": [
                            { "$ref": "#/subclasses/heating" },
                            { "$ref": "#/subclasses/pump" }
                        ]
                    }
                }
            }
        },

        "pump": {
            "properties": {
                "name": { "enum": ["pump"] }
            }
        },

        "printer": {
            "properties": {
                "name": { "enum": ["printer"] },
                "type": { "enum": ["laser", "led", "ink jet", "dot matrix"] },
                "components": { 
                    "type": "array",
                    "description": "meta-appliance made up of other appliances",
                    "items": {
                        "anyOf": [
                            { "$ref": "#/subclasses/office" }
                        ]
                    }
                }
            }
        },

        "office": {
            "properties": {
                "name": { "enum": ["scanner", "fax", "photocopier"] }
            }
        },

        "charger": {
            "properties": {
                "name": { "enum": ["charger"] },
                "type": { "enum": ["mobile phone", "tablet", "ebook", 
                                   "baby hoover", "cordless phone"] }
            }
        },

        "misc": {
            "properties": {
                "name": { "enum": [
                    "fan", 

                    "spin dryer", "tumble dryer", "washing machine", 
                    "washer dryer", "dish washer",

                    "rf booster", "video sender", "digital picture frame",

                    "hair dryer", "hair straightener", "trouser press", 
                    "sun bed", "electric blanket", 
                    "baby monitor rx", "baby monitor tx", "clothes iron",

                    "broadband router", "wifi base station", 
                    "ethernet hub", "usb hub", "modem",
                    "laptop computer", "desktop computer",
                    "external hard drive", "ups", "paper shredder",

                    "soldering iron", "drill", "saw"

                ] }
            }
        }

    },
    "definitions": {
        "fuel": { "enum": [ "electricity", "gas", "oil", 
                            "coal", "wood", "biomass" ] }
    }
}
