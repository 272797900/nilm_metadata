{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "https://raw.github.com/nilmtk/nilm_metadata/master/schema/appliance.json",
    "title": "Appliance",
    "description": "Metadata for a Appliances",
    "type": "object",
    "allOf": [
        { 
            "_comments": "------PROPERTIES COMMON TO ALL APPLIANCES----------",
            "properties": {
                "instance": { "$ref": "instance.json" },
                "room": { "$ref": "room.json" },
                "manufacturer": { "type": "string" },
                "model": { "type": "string" },
                "meters": { 
                    "type": "array", 
                    "items": { "$ref": "instance.json" },
                    "unique": true 
                },
                "on_power_threshold": { 
                    "type": "number", 
                    "description": "watts", 
                    "minimum": 0
                },
                "min_off_duration": { "format": "time", "type": "string" },
                "min_on_duration": { "format": "time", "type": "string" },
                "category": { "type": "string" }
            },
            "required": ["name"]
        },
        { 
            "$ref": "#/all_subclasses"
        }
    ],
    "all_subclasses": {
        "oneOf": 
        [
                { "$ref": "#/subclasses/fridge" },
                { "$ref": "#/subclasses/screen" },
                { "$ref": "#/subclasses/projector" },
                { "$ref": "#/subclasses/kitchen_misc" },
                { "$ref": "#/subclasses/cooker" },
                { "$ref": "#/subclasses/oven" },
                { "$ref": "#/subclasses/hob_or_grill" },
                { "$ref": "#/subclasses/sockets" },
                { "$ref": "#/subclasses/heating" },
                { "$ref": "#/subclasses/heat_pump" },
                { "$ref": "#/subclasses/shower_or_tub" },
                { "$ref": "#/subclasses/pump" },
                { "$ref": "#/subclasses/misc" }
        ]
    },
   
    "subclasses": {

        "fridge": {   
            "properties": {
                "name": { "enum": ["fridge", "fridge freezer", "freezer"] },
                "type": { "enum": ["upright", "chest", "american"] },
                "freezer_is_separate_thermal_zone": { "type": "boolean" }
            }
        },

        "kitchen_misc": {
            "properties": {
                "name": { "enum": [
                    "wine cooler", "food mixer", 
                    "vacuum cleaner", "mini vacuum cleaner charger",
                    "yoghurt maker", "water filter",
                    "microwave", "kettle", "toaster", "fryer", "bread maker", 
                    "coffee maker", "food steamer", "bottle warmer", 
                    "steriliser", "plate warmer", "slow cooker", "other cooking"
                ] }
            }
        },

        "screen": {   
            "properties": {
                "name": { "enum": ["tv", "computer monitor"] },
                "screen_size": { 
                    "type": "number",
                    "description": "diagonal size in inches",
                    "minimum": 0,
                    "exclusiveMinimum": true
                }
            }
        },

        "projector": {
            "properties": {
                "name": { "enum": ["projector"] }
            }
        },

        "cooker": {
            "properties": {
                "name": { "enum": ["cooker"] },
                "components": { 
                    "type": "array",
                    "description": "meta-appliance made up of other appliances",
                    "items": {
                        "anyOf": [
                            { "$ref": "#/subclasses/oven" },
                            { "$ref": "#/subclasses/hob_or_grill" }
                        ]
                    }
                }
            }
        },

        "oven": {
            "properties": {
                "name": { "enum": ["oven"] },
                "fan": { "type": "boolean" },
                "fuel": { "$ref": "#/definitions/fuel" }
            }
        },

        "hob_or_grill": {
            "properties": {
                "name": { "enum": ["hob", "grill"] },
                "fuel": { "$ref": "#/definitions/fuel" }
            }
        },

        "sockets": {
            "properties": {
                "name": { "enum": ["sockets"] }
            },
            "required": ["name", "room"]
        },

        "heating": {
            "properties": {
                "name": { "enum": [ 
                    "boiler", "space heater", "storage heater",
                    "water heater" ] },
                "fuel": { "$ref": "#/definitions/fuel" }
            }
        },

        "heat_pump": {
            "properties": {
                "name": { "enum": ["heat pump", "air conditioning" ] },
                "heat_source": { "enum": ["ground", "air", "water"] }
            }
        },

        "shower_or_tub": {
            "properties": {
                "name": { "enum": ["shower", "hot tub"] },
                "components": { 
                    "type": "array",
                    "description": "meta-appliance made up of other appliances",
                    "items": {
                        "anyOf": [
                            { "$ref": "#/subclasses/heating" },
                            { "$ref": "#/subclasses/pump" }
                        ]
                    }
                }
            }
        },

        "pump": {
            "properties": {
                "name": { "enum": ["pump"] }
            }
        },

        "misc": {
            "properties": {
                "name": { "enum": ["fan" ] }
            }
        }

    },
    "definitions": {
        "fuel": { "enum": [ "electricity", "gas", "oil", 
                            "coal", "wood", "biomass" ] }
    }
}
