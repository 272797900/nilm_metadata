{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "https://raw.github.com/nilmtk/nilm_metadata/master/schema/appliance.json",
    "title": "Appliance",
    "description": "Metadata for a Appliances",
    "type": "object",
    "allOf": [
        { 
            "_comments": "------PROPERTIES COMMON TO ALL APPLIANCES----------",
            "properties": {
                "instance": { "$ref": "instance.json" },
                "room": { "$ref": "room.json" },
                "manufacturer": { "type": "string" },
                "model": { "type": "string" },
                "meters": { 
                    "type": "array", 
                    "items": { "$ref": "instance.json" },
                    "unique": true 
                },
                "on_power_threshold": { 
                    "type": "number", 
                    "description": "watts", 
                    "minimum": 0
                },
                "min_off_duration": { "format": "time", "type": "string" },
                "min_on_duration": { "format": "time", "type": "string" },
                "category": { "type": "string" }
            },
            "required": ["name"]
        },
        { 
            "$ref": "#/all_subclasses"
        }
    ],
    "all_subclasses": {
        "oneOf": 
        [
                { "$ref": "#/subclasses/fridge" },
                { "$ref": "#/subclasses/screen" },
                { "$ref": "#/subclasses/projector" },
                { "$ref": "#/subclasses/kitchen_misc" },
                { "$ref": "#/subclasses/cooker" },
                { "$ref": "#/subclasses/oven" },
                { "$ref": "#/subclasses/hob_or_grill" }
        ]
    },
   
    "subclasses": {

        "fridge": {   
            "properties": {
                "name": { "enum": ["fridge", "fridge_freezer", "freezer"] },
                "type": { "enum": ["upright", "chest", "american"] },
                "freezer_is_separate_thermal_zone": { "type": "boolean" }
            }
        },

        "kitchen_misc": {
            "properties": {
                "name": { "enum": ["wine_cooler",
                                   "food_mixer", 
                                   "vacuum_cleaner", 
                                   "mini_vacuum_cleaner_charger",
                                   "yoghurt_maker",
                                   "water_filter",
                                   "kitchen_outlets"] }
            }
        },

        "screen": {   
            "properties": {
                "name": { "enum": ["tv", "computer_monitor"] },
                "screen_size": { 
                    "type": "number",
                    "description": "diagonal size in inches",
                    "minimum": 0,
                    "exclusiveMinimum": true
                }
            }
        },

        "projector": {
            "properties": {
                "name": { "enum": ["projector"] }
            }
        },

        "cooker": {
            "properties": {
                "name": { "enum": ["cooker"] },
                "components": { "type": "array",
                                "description": "meta-appliance made up of other appliances",
                                "items": {
                                    "anyOf": [
                                        { "$ref": "#/subclasses/oven" },
                                        { "$ref": "#/subclasses/hob_or_grill" }
                                    ]
                                }}
            }
        },

        "oven": {
            "properties": {
                "name": { "enum": ["oven"] },
                "fan": { "type": "boolean" },
                "fuel": { "$ref": "#/definitions/fuel" }
            }
        },

        "hob_or_grill": {
            "properties": {
                "name": { "enum": ["hob", "grill"] },
                "fuel": { "$ref": "#/definitions/fuel" }
            }
        }

    },
    "definitions": {
        "fuel": { "enum": [ "electricity", "gas", "oil", 
                            "coal", "wood", "biomass" ] }
    }
}
